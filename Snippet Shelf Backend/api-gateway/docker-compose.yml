version: '3.8'

services:
  api-gateway:
    build:
      # Use the current directory as the build context
      context: .
      dockerfile: Dockerfile
    image: api-gateway:latest
    container_name: api-gateway
    ports:
      # Maps host port 4010 to container port 4004
      - "4010:4004"
    environment:
      - AUTH_SERVICE_URL=http://auth-service:4011
    networks:
      # This service will connect to the 'internal' network
      - internal

# --- Important Network Configuration ---
# This tells Compose to use a pre-existing network
# named 'internal', allowing it to communicate with
# your other microservices (like auth-service).
networks:
  internal:
    external: true